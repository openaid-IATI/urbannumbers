function get_random_city_within_selection(e,t){var n=e[Math.floor(Math.random()*e.length)];t&&n==t&&(n=get_random_city_within_selection(e,t));return n}function UnhabitatOipaCompareFilters(){this.get_url=function(e,t){if(t)var n=search_url+"indicator-filter-options/?format=json&categories__in=Public%20spaces,Slum%20dwellers,City%20prosperity&adm_division__in=city"+t;else var n=search_url+"indicator-filter-options/?format=json&categories__in=Public%20spaces,Slum%20dwellers,City%20prosperity&adm_division__in=city&indicators__in="+get_parameters_from_selection(this.selection.indicators);return n}}function UnhabitatOipaIndicatorFilters(){this.get_url=function(e,t){if(t)var n=search_url+"indicator-filter-options/?format=json&categories__in=Public%20spaces,Slum%20dwellers,City%20prosperity"+t;else var n=search_url+"indicator-filter-options/?format=json&categories__in=Public%20spaces,Slum%20dwellers,City%20prosperity&indicators__in="+get_indicator_parameters_from_selection(this.selection.indicators)+"&regions__in="+get_parameters_from_selection(this.selection.regions)+"&countries__in="+get_parameters_from_selection(this.selection.countries)+"&cities__in="+get_parameters_from_selection(this.selection.cities);return n};this.reset_filters=function(){jQuery("#"+this.filter_wrapper_div+" input[type=checkbox]").attr("checked",!1);filter.selection.search="";filter.selection.query="";filter.selection.country="";filter.selection.region="";filter.selection.regions=[];filter.selection.cities=[];filter.selection.countries=[];filter.selection.indicators=[];filter.selection.indicators.push({id:"urban_population_countries",name:"Urban population â€“ Countries",type:"Slum dwellers"});filter.save(!0)}}function get_wiki_city_data(e,t){e=e.replace(" ","_");var n="";$.getJSON("http://en.wikipedia.org/w/api.php?action=parse&page="+e+"&prop=text&section=0&format=json&callback=?",function(e){for(n in e.parse.text){var n=e.parse.text[n].split("<p>"),r="";for(p in n){n[p]=n[p].split("<!--");if(n[p].length>1){n[p][0]=n[p][0].split(/\r\n|\r|\n/);n[p][0]=n[p][0][0];n[p][0]+="</p> "}n[p]=n[p][0];if(n[p].indexOf("</p>")==n[p].length-5){var i=n[p].replace(/<(?:.|\n)*?>/gm,""),s=i.split(/\r\n|\r|\n/);for(newline in s)if(s[newline].substring(0,11)!="Cite error:"){r+=s[newline];r+="\n"}}}r=r.substring(0,r.length-2);r=r.replace(/\[\d+\]/g,"");n=unescape(r);var o=n.substring(0,500),u=n.substring(500);console.log(u);var a=u.substr(0,u.indexOf(" ")),u=u.substr(u.indexOf(" ")+1);o+=a;var f=o+' <a href="#" class="wiki-read-more">Read more.. </a><div class="wiki-read-more-hidden">'+u+"</div>";u==""&&(f=o);o!=""&&(f+='<div class="city-wikipedia-disclaimer">Source: wikipedia. </div>');jQuery("."+t+"-city-wikipedia").html(f);jQuery(".wiki-read-more").click(function(){jQuery(this).next(".wiki-read-more-hidden").show(500);jQuery(this).remove()})}})}$("#main-map .change-basemap-link").click(function(e){e.preventDefault();var t=$(this).attr("name");map.change_basemap(t)});$("#left-map .change-basemap-link").click(function(e){e.preventDefault();var t=$(this).attr("name");leftmap.change_basemap(t)});$("#right-map .change-basemap-link").click(function(e){e.preventDefault();var t=$(this).attr("name");rightmap.change_basemap(t)});$(".filters-save-button").click(function(e){e.preventDefault();var t=filter.save();t&&$(".sort-list .active .opener").click()});$("#reset-filters").click(function(e){e.preventDefault();filter.reset_filters()});$(".compare-filters-save-button").click(function(e){e.preventDefault();var t=filter.save();t&&$(".sort-list .active .opener").click()});$("#compare-cities-randomize").click(function(e){e.preventDefault();OipaCompare.randomize()});$("#indicator-filter-wrapper .filter-open").click(function(e){var t=$(this).attr("name");filter.reload_specific_filter(t)});$("#opener-left-cities").click(function(e){e.preventDefault();filter.reload_specific_filter("left-cities",null)});$("#opener-right-cities").click(function(e){e.preventDefault();filter.reload_specific_filter("right-cities",null)});$("#header-login-register-button").click(function(e){if($(this).attr("href")=="#"){e.preventDefault();$("#hoover-wrapper").show();$("#urbannumbers-login").show()}});$("#lost-password-login").click(function(e){e.preventDefault();$("#urbannumbers-login").hide();$("#urbannumbers-lostpassword").show()});$("#register-button").click(function(e){e.preventDefault();$("#urbannumbers-register").show();$("#urbannumbers-login").hide()});$("#delete-account-button").click(function(e){e.preventDefault();$("#hoover-wrapper").show();$("#urbannumbers-remove-account").show()});$(".close-login").click(function(e){e.preventDefault();$("#hoover-wrapper").hide();$("#urbannumbers-login").hide();$("#urbannumbers-register").hide();$("#urbannumbers-lostpassword").hide()});UnhabitatOipaCompareFilters.prototype=new OipaCompareFilters;UnhabitatOipaIndicatorFilters.prototype=new OipaIndicatorFilters;